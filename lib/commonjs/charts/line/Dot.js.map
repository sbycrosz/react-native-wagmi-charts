{"version":3,"sources":["Dot.tsx"],"names":["AnimatedCircle","Animated","createAnimatedComponent","Circle","LineChartDot","displayName","at","color","defaultColor","dotProps","hasOuterDot","defaultHasOuterDot","hasPulse","inactiveColor","outerDotProps","pulseBehaviour","pulseDurationMs","showInactiveColor","size","outerSize","isActive","parsedPath","React","useContext","LineChartDimensionsContext","isInactive","_isInactive","LineChartPathContext","opacity","x","y","value","animatedDotProps","cx","cy","animatedOuterDotProps","defaultProps","r","easing","Easing","out","sin","animatedOpacity","duration","scale"],"mappings":"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","sourcesContent":["import * as React from 'react';\n\nimport Animated, {\n  Easing,\n  useAnimatedProps,\n  useDerivedValue,\n  withRepeat,\n  withSequence,\n  withTiming,\n} from 'react-native-reanimated';\nimport { Circle, CircleProps } from 'react-native-svg';\n\nimport { LineChartDimensionsContext } from './Chart';\nimport { LineChartPathContext } from './LineChartPathContext';\nimport { getXPositionForCurve } from './utils/getXPositionForCurve';\nimport { getYForX } from 'react-native-redash';\nimport { useLineChart } from './useLineChart';\n\nconst AnimatedCircle = Animated.createAnimatedComponent(Circle);\n\nexport type LineChartDotProps = {\n  dotProps?: Animated.AnimateProps<CircleProps>;\n  outerDotProps?: Animated.AnimateProps<CircleProps>;\n  color?: string;\n  inactiveColor?: string;\n  showInactiveColor?: boolean;\n  at: number;\n  size?: number;\n  hasPulse?: boolean;\n  hasOuterDot?: boolean;\n  /**\n   * If `always`, the outer dot will still animate when interaction is active.\n   *\n   * If `while-inactive`, the outer dot will animate only when the interaction is inactive.\n   *\n   * Default: `while-inactive`\n   */\n  pulseBehaviour?: 'always' | 'while-inactive';\n  /**\n   * Defaults to `size * 4`\n   */\n  outerSize?: number;\n  pulseDurationMs?: number;\n};\n\nLineChartDot.displayName = 'LineChartDot';\n\nexport function LineChartDot({\n  at,\n  color: defaultColor = 'black',\n  dotProps,\n  hasOuterDot: defaultHasOuterDot = false,\n  hasPulse = false,\n  inactiveColor,\n  outerDotProps,\n  pulseBehaviour = 'while-inactive',\n  pulseDurationMs = 800,\n  showInactiveColor = true,\n  size = 4,\n  outerSize = size * 4,\n}: LineChartDotProps) {\n  const { isActive } = useLineChart();\n  const { parsedPath } = React.useContext(LineChartDimensionsContext);\n\n  ////////////////////////////////////////////////////////////\n\n  const { isInactive: _isInactive } = React.useContext(LineChartPathContext);\n  const isInactive = showInactiveColor && _isInactive;\n  const color = isInactive ? inactiveColor || defaultColor : defaultColor;\n  const opacity = isInactive && !inactiveColor ? 0.5 : 1;\n  const hasOuterDot = defaultHasOuterDot || hasPulse;\n\n  ////////////////////////////////////////////////////////////\n\n  const x = useDerivedValue(() => {\n    return withTiming(getXPositionForCurve(parsedPath, at));\n  }, [at, parsedPath]);\n\n  const y = useDerivedValue(\n    () => withTiming(getYForX(parsedPath!, x.value) || 0),\n    [parsedPath, x]\n  );\n\n  ////////////////////////////////////////////////////////////\n\n  const animatedDotProps = useAnimatedProps(\n    () => ({\n      cx: x.value,\n      cy: y.value,\n    }),\n    [x, y]\n  );\n\n  const animatedOuterDotProps = useAnimatedProps(() => {\n    let defaultProps = {\n      cx: x.value,\n      cy: y.value,\n      opacity: 0.1,\n      r: outerSize,\n    };\n\n    if (!hasPulse) {\n      return defaultProps;\n    }\n\n    if (isActive.value && pulseBehaviour === 'while-inactive') {\n      return {\n        ...defaultProps,\n        r: 0,\n      };\n    }\n\n    const easing = Easing.out(Easing.sin);\n    const animatedOpacity = withRepeat(\n      withSequence(\n        withTiming(0.8),\n        withTiming(0, {\n          duration: pulseDurationMs,\n          easing,\n        })\n      ),\n      -1,\n      false\n    );\n    const scale = withRepeat(\n      withSequence(\n        withTiming(0),\n        withTiming(outerSize, {\n          duration: pulseDurationMs,\n          easing,\n        })\n      ),\n      -1,\n      false\n    );\n\n    if (pulseBehaviour === 'while-inactive') {\n      return {\n        ...defaultProps,\n        opacity: isActive.value ? withTiming(0) : animatedOpacity,\n        r: isActive.value ? withTiming(0) : scale,\n      };\n    }\n    return {\n      ...defaultProps,\n      opacity: animatedOpacity,\n      r: scale,\n    };\n  }, [hasPulse, isActive, outerSize, pulseBehaviour, pulseDurationMs, x, y]);\n\n  ////////////////////////////////////////////////////////////\n\n  return (\n    <>\n      <AnimatedCircle\n        animatedProps={animatedDotProps}\n        r={size}\n        fill={color}\n        opacity={opacity}\n        {...dotProps}\n      />\n      {hasOuterDot && (\n        <AnimatedCircle\n          animatedProps={animatedOuterDotProps}\n          fill={color}\n          {...outerDotProps}\n        />\n      )}\n    </>\n  );\n}\n"]}